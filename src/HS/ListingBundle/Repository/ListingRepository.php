<?php

namespace HS\ListingBundle\Repository;

use Doctrine\Common\Persistence\ManagerRegistry;
use Doctrine\Bundle\DoctrineBundle\Repository\ServiceEntityRepository;
use HS\ListingBundle\Entity\Listing;

/**
 * ListingRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class ListingRepository extends ServiceEntityRepository
{

	public function __construct(ManagerRegistry $registry)
    {
        parent::__construct($registry, Listing::class);
    }

	/**
	  * 
	  *	Returns all the listings created by the user passed as argument
	  *
	  * @param int $id The id of the actual user
	  *    
	  *
	  * @return array of ManageListing
	  */
	public function getUserListings($id)
	{
		return $this->findBy(array('user' => $id));
	}

    /**
     * Return all the listings
     * TODO add paging
     *
     * @return Listing
     */
	public function getListings() {
	    return $this->findBy(array());
    }

	/**
	 * Add a listing to the database
	 * @param $listing the listing to add
	 * 	 
	 * @return boolean
	 */
	public function addListing($listing)
	{
		$em = $this->getEntityManager();
		$em->persist($listing);
		$em->flush();

	}
	
	/**
	 * Return the listing matching the id passed as argument
	 * @param $id the id of the listing 
	 * @return Listing
	 */
	public function findById($id)
	{
		return $this->findOneBy(array('id' => $id));
	}

	/**
	 * Delete listing by id
	 * @param $id the id of the listing to delete 
	 * @return void
	 */
	public function delete($listing)
	{
		$em = $this->getEntityManager();
		$em->remove($listing);
        $em->flush();
	}


}
